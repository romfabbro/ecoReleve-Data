/****** Script de la commande SelectTopNRows Ã  partir de SSMS  ******/
delete 
FROM ModuleForms 
WHERE ID in (

SELECT MAX(ID) 

     
  FROM [EcoReleve_ECWP].[dbo].ModuleForms g
GROUP By [Module_ID]
      ,[TypeObj]
      ,[Name]

HAVING count(*) > 1 )

GO 

/****** Object:  Index [IX_Uniqu_ModuleForm_Conf]    Script Date: 06/09/2016 15:17:38 ******/
CREATE UNIQUE NONCLUSTERED INDEX [IX_Uniqu_ModuleForm_Conf] ON [dbo].[ModuleForms]
(
	[module_id] ASC,
	[TypeObj] ASC,
	[Name] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON)
GO


CREATE UNIQUE NONCLUSTERED INDEX [IX_Unique_Station_Fielworker] ON [dbo].[Station_FieldWorker]
(
	[ID] ASC
)
INCLUDE ( 	[FK_Station],
	[FK_FieldWorker]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON)
GO





INSERT INTO [dbo].[TVersion] (TVer_FileName,TVer_Date,TVer_DbName) VALUES ('90_Add_Unic_Index ',GETDATE(),(SELECT db_name()))


GO
